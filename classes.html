
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Classes &#8212; coding standards 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Typehinting" href="typehinting.html" />
    <link rel="prev" title="Libraries" href="libraries.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="classes">
<h1>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h1>
<section id="data-classes">
<h2>Data classes<a class="headerlink" href="#data-classes" title="Permalink to this headline">¶</a></h2>
<p>While <a class="reference internal" href="typehinting.html"><span class="doc">typehinting</span></a> is flexible enough to create your own specifications
of, for example, a dataclass, it is easier to use <code class="docutils literal notranslate"><span class="pre">pydantic</span></code> for typical cases like have
a dataclass. read more in the <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/dataclasses/">pydantic docs</a> about
data classes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">pydantic.dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">User</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;John Doe&#39;</span>
    <span class="n">signup_ts</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p>Pydantic is great for validation of settings and inputdata, and for sharing requirements between machines.
The code above checks if the data loaded actually is an integer, string etc etc.
It automatically implements coversion and validation, so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;123&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Will transform the id to an integer, and fail if the input is not compatible.
The decorator also implements dunder methods like: <code class="docutils literal notranslate"><span class="pre">__init__</span></code>, <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> (how it is printed), <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> (how it is used with operators like <code class="docutils literal notranslate"><span class="pre">==</span></code>) etc.
You can read more about the comparison between native (3.7) dataclasses, attrs and pydantic in this <a class="reference external" href="https://jackmckew.dev/dataclasses-vs-attrs-vs-pydantic.html">blog</a></p>
</section>
<section id="base-settings">
<h2>Base settings<a class="headerlink" href="#base-settings" title="Permalink to this headline">¶</a></h2>
<p>A slightly different situation is where you have all sorts of settings for your project.
Typically, you will want to specify things like:</p>
<ul class="simple">
<li><p>a data directory</p></li>
<li><p>certain default options for functions</p></li>
<li><p>specific filenames to be loaded</p></li>
<li><p>column names</p></li>
</ul>
<p>A first rule-of-thumb is to never hardcode things like this. So, never do</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/file.csv&quot;</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>But, instead, go for:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span>
    <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;file.csv&quot;</span><span class="p">)</span>
 <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="n">filename</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This way, it is very easy if you want to change the location of data, filename, etc etc.</p>
<p>However, this can still cause problems. It might be the case that you end up with all sorts
of settings, spread over multiple notebooks. Changing urls, filenames etc will then turn
into an excercise that will require you to walk trough every notebook, and to check every single cell.
That might be ok if you made the notebooks yourself, but you will curse a lot if you get
an unstructured set of notebooks from someone else that is no longer around to explain the details.</p>
<p>So, a good practice is; in addition to never hardcoding settings, gather all you settings
in one place.</p>
<p>So, you create a file called settings.py, that looks like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseSettings</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>


<span class="k">class</span> <span class="nc">Settings</span><span class="p">(</span><span class="n">BaseSettings</span><span class="p">):</span>
    <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../data/&quot;</span><span class="p">)</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;MonthlySales&quot;</span>
    <span class="n">data_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;file.csv&quot;</span><span class="p">)</span>
    <span class="n">hierarchy</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;veggies&quot;</span><span class="p">,</span> <span class="s2">&quot;paprika&quot;</span><span class="p">]</span>
    <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
</pre></div>
</div>
<p>In your notebook, you can now import the settings like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src.settings</span> <span class="kn">import</span> <span class="n">settings</span>
</pre></div>
</div>
<p>Note that you have a few advantages at once, that are also improvements upon saving settings
in a <code class="docutils literal notranslate"><span class="pre">.json</span></code> or <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> file.</p>
<ol class="arabic simple">
<li><p>You can use typehinting. This will be used by your <a class="reference internal" href="linting.html"><span class="doc">linters</span></a> to check for consistency.</p></li>
<li><p>You can load python object. Sure, you will find a way to load a list of floats from <code class="docutils literal notranslate"><span class="pre">.json</span></code>. But what about a <code class="docutils literal notranslate"><span class="pre">Path</span></code>? Or a <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> from sklearn? You could still create workaround with <code class="docutils literal notranslate"><span class="pre">eval</span></code>, but <code class="docutils literal notranslate"><span class="pre">BaseSettings</span></code> is easier.</p></li>
<li><p>For free, you get functions like <code class="docutils literal notranslate"><span class="pre">.dict()</span></code> or <code class="docutils literal notranslate"><span class="pre">.json</span></code> to create exports</p></li>
<li><p>pydantic will integrate with <code class="docutils literal notranslate"><span class="pre">mypy</span></code>, VS code, <code class="docutils literal notranslate"><span class="pre">hypothesis</span></code> etc ec.</p></li>
</ol>
<p>Coming back to our example, you would now get:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span>
    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">data_file</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can find <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/settings/">the documentation here</a>.</p>
</section>
<section id="abstract-classes">
<h2>Abstract Classes<a class="headerlink" href="#abstract-classes" title="Permalink to this headline">¶</a></h2>
<p>Base python introduced abstract base classes with <a class="reference external" href="https://www.python.org/dev/peps/pep-3119/">PEP 3119</a>.</p>
<p>A pretty nice introduction into the matter is <a class="reference external" href="https://blog.teclado.com/python-abc-abstract-base-classes/">this blog</a> from which the following examples are copied.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Lion</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">give_food</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feeding a lion with raw meat!&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Panda</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">feed_animal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feeding a panda with some tasty bamboo!&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">feed_snake</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feeding a snake with mice!&quot;</span><span class="p">)</span>

<span class="n">leo</span> <span class="o">=</span> <span class="n">Lion</span><span class="p">()</span>
<span class="n">po</span> <span class="o">=</span> <span class="n">Panda</span><span class="p">()</span>
<span class="n">sam</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
</pre></div>
</div>
<p>This could be code that evolved over time. However, if you would at some point want
to automate the feeding of the animals, you might want to do something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">zoo</span> <span class="o">=</span> <span class="p">[</span><span class="n">leo</span><span class="p">,</span> <span class="n">po</span><span class="p">,</span> <span class="n">sam</span><span class="p">]</span> <span class="c1"># Could be many more animals there!</span>

<span class="k">for</span> <span class="n">animal</span> <span class="ow">in</span> <span class="n">zoo</span><span class="p">:</span>
    <span class="n">animal</span><span class="o">.</span><span class="n">feed</span><span class="p">()</span> <span class="c1"># This will throw an AttributeError!</span>
</pre></div>
</div>
<p>so, in order to avoid this, you could do this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>

<span class="k">class</span> <span class="nc">Animal</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span> <span class="c1"># Inherit from ABC(Abstract base class)</span>
    <span class="nd">@abstractmethod</span>  <span class="c1"># Decorator to define an abstract method</span>
    <span class="k">def</span> <span class="nf">feed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Lion</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span> <span class="c1">#this inheriting will make sure</span>
    <span class="k">def</span> <span class="nf">feed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># you get an TypeError here if you dont implement .feed()!</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feeding a lion with raw meat!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">coding standards</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tldr.html">TLDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="motivation.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="libraries.html">Libraries</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#data-classes">Data classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#base-settings">Base settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#abstract-classes">Abstract Classes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="typehinting.html">Typehinting</a></li>
<li class="toctree-l1"><a class="reference internal" href="linting.html">Linting</a></li>
<li class="toctree-l1"><a class="reference internal" href="poetry.html">Poetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookiecutter.html">Data Science cookiecutter</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="libraries.html" title="previous chapter">Libraries</a></li>
      <li>Next: <a href="typehinting.html" title="next chapter">Typehinting</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, R.Grouls.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/classes.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>