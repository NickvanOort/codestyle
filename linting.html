
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Linting &#8212; coding standards 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Poetry" href="poetry.html" />
    <link rel="prev" title="Typehinting" href="typehinting.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="linting">
<h1>Linting<a class="headerlink" href="#linting" title="Permalink to this headline">¶</a></h1>
<p>By default, I will install the following libraries for linting:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">black</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flake8</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isort</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mypy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pep8-naming</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flake8-annotations</span></code></p></li>
</ul>
<p>And I will create a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> with this template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">PHONY</span><span class="p">:</span> <span class="n">lint</span> <span class="nb">format</span>

<span class="nb">format</span><span class="p">:</span>
        <span class="n">poetry</span> <span class="n">run</span> <span class="n">isort</span> <span class="o">-</span><span class="n">v</span> <span class="n">src</span>
        <span class="n">poetry</span> <span class="n">run</span> <span class="n">black</span> <span class="n">src</span>

<span class="n">lint</span><span class="p">:</span>
        <span class="n">poetry</span> <span class="n">run</span> <span class="n">flake8</span> <span class="n">src</span>
        <span class="n">poetry</span> <span class="n">run</span> <span class="n">mypy</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">strict</span><span class="o">-</span><span class="n">optional</span> <span class="o">--</span><span class="n">warn</span><span class="o">-</span><span class="n">unreachable</span> <span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">error</span><span class="o">-</span><span class="n">codes</span> <span class="n">src</span>
</pre></div>
</div>
<p>Alternatively, you can also run directly from the command line things like <code class="docutils literal notranslate"><span class="pre">black</span> <span class="pre">src</span></code>,
which will format all python files inside the <code class="docutils literal notranslate"><span class="pre">src/</span></code> folder</p>
<section id="formatters">
<h2>Formatters<a class="headerlink" href="#formatters" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">black</span></code> calls itself the <cite>uncompromising code formatter</cite>. It is very opiniated about
formatting code, but does this in a consistent style. You hand over control about
formatting, but you will get consistency in return and never have to think about formatting
again. read the <a class="reference external" href="https://github.com/psf/black">black docs</a></p>
<p><code class="docutils literal notranslate"><span class="pre">isort</span></code> is much less invasive. Only thing it does is sorting your imports. But, yeah, why
not, it is anoying to sort those too so why not automate that <a class="reference external" href="https://pycqa.github.io/isort/">isort</a></p>
</section>
<section id="type-checkers">
<h2>Type checkers<a class="headerlink" href="#type-checkers" title="Permalink to this headline">¶</a></h2>
<p>After running the formatters, I can run <a class="reference external" href="https://flake8.pycqa.org/en/latest/">flake8</a>.
Black will take care of all the nitty gritty <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP 8 details</a>, so a lot of errors will go away
after running the formatters. However, there can still be stuff worth looking at.</p>
<p>However, some checks are too tight, so typically I will use a tox.ini or setup.cfg file with a snippet like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">flake8</span><span class="p">]</span>
<span class="n">ignore</span> <span class="o">=</span> <span class="n">W503</span><span class="p">,</span> <span class="n">ANN101</span><span class="p">,</span> <span class="n">ANN002</span><span class="p">,</span> <span class="n">ANN003</span>
<span class="nb">max</span><span class="o">-</span><span class="n">line</span><span class="o">-</span><span class="n">length</span> <span class="o">=</span> <span class="mi">88</span>
<span class="nb">max</span><span class="o">-</span><span class="n">complexity</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">exclude</span> <span class="o">=</span> <span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<ul class="simple">
<li><p>W503 is not compatible with black.</p></li>
<li><p>ANN101 is annotation for <cite>self</cite>, which gives me too much headaches and is not worth the struggle.</p></li>
<li><p>ANN002, ANN003 is annotation for *args and **kwargs, which is annoying too.</p></li>
<li><p>max-line-lenght 88 is compatible with black default</p></li>
<li><p>max-complexity This feature is quite useful to detect over-complex code. According to McCabe, anything that goes beyond 10 is too complex. See <a class="reference external" href="https://en.wikipedia.org/wiki/Cyclomatic_complexity">https://en.wikipedia.org/wiki/Cyclomatic_complexity</a></p></li>
</ul>
<p>I will also occasionally overwrite errors in specifice lines with <cite># noqa</cite> comments, see <a class="reference external" href="https://flake8.pycqa.org/en/3.1.1/user/ignoring-errors.html">ignoring errors</a></p>
<p>Finally, <code class="docutils literal notranslate"><span class="pre">mypy</span></code>. Together with <code class="docutils literal notranslate"><span class="pre">flake8-annotations</span></code> and <code class="docutils literal notranslate"><span class="pre">pep8-naming</span></code>, and after running the formatters,
you will typically still get a lot of errors, especially in the beginning. Using the linter and
investigating errors is how I learned to use typehinting properly.</p>
<p>After you added proper typehinting everywhere, mypy will start checking consistency.</p>
<p>Imagine you have a function that retrieves the median of a list of customers,
and it is important that the customers are discrete counts, and thus an integer. The custom
median function will return an <code class="docutils literal notranslate"><span class="pre">int</span></code>, but the <code class="docutils literal notranslate"><span class="pre">get_value</span></code> function expects a <code class="docutils literal notranslate"><span class="pre">float</span></code>. This
is inconsistent, and you should make up your mind about the types. Obviously, this is a simple
example, but at some point you might get pretty complex datastructures and mypy will help
you to keep your code consistent and warn you about loopholes that might cause errors, even
though your code would function fine when you are testing it now.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">median</span><span class="p">(</span><span class="n">values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span>
    <span class="k">return</span> <span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># inconsistent: this returns an int</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">coding standards</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tldr.html">TLDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="motivation.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="libraries.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="typehinting.html">Typehinting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Linting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#formatters">Formatters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#type-checkers">Type checkers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="poetry.html">Poetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookiecutter.html">Data Science cookiecutter</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="typehinting.html" title="previous chapter">Typehinting</a></li>
      <li>Next: <a href="poetry.html" title="next chapter">Poetry</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, R.Grouls.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/linting.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>